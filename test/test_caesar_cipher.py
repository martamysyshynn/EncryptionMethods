import unittest
from caesar_cipher import caesars_cipher_encrypt, caesars_cipher_encrypt_by_blocks, caesars_cipher_decrypt, caesars_cipher_decrypt_by_blocks, frequency_analysis, caesars_cipher_decrypt_by_frequency_analysis

class TestProgram(unittest.TestCase):
    def setUp(self):
        self.alphabet_eng = list('ABCDEFGHIJKLMNOPQRSTUVWXYZ')
        self.alphabet_ukr = list('АБВГҐДЕЄЖЗИІЇЙКЛМНОПРСТУФХЦЧШЩЬЮЯ')

    def test_encrypt(self):
        self.assertEqual(caesars_cipher_encrypt('CRYPTOGRAPHY', self.alphabet_eng, 3), 'FUBSWRJUDSKB')
        self.assertEqual(caesars_cipher_encrypt('БАРОКО', self.alphabet_ukr, 3), 'ҐГУСНС')

    def test_decrypt(self):
        self.assertEqual(caesars_cipher_decrypt('FUBSWRJUDSKB', self.alphabet_eng, 3), 'CRYPTOGRAPHY')
        self.assertEqual(caesars_cipher_decrypt('ҐГУСНС', self.alphabet_ukr, 3), 'БАРОКО')

    def test_encrypt_by_blocks(self):
        self.assertEqual(caesars_cipher_encrypt_by_blocks("Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem IpsumLorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem IpsumLorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum", 10, self.alphabet_eng, 4), "PSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQPSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQ PSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQPSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQ")

    def test_decrypt_by_blocks(self):
        self.assertEqual(caesars_cipher_decrypt_by_blocks("PSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQPSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQ PSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQPSVIQ MTWYQ MW WMQTPC HYQQC XIBX SJ XLI TVMRXMRK ERH XCTIWIXXMRK MRHYWXVC. PSVIQ MTWYQ LEW FIIR XLI MRHYWXVC'W WXERHEVH HYQQC XIBX IZIV WMRGI XLI 1500W, ALIR ER YRORSAR TVMRXIV XSSO E KEPPIC SJ XCTI ERH WGVEQFPIH MX XS QEOI E XCTI WTIGMQIR FSSO. MX LEW WYVZMZIH RSX SRPC JMZI GIRXYVMIW, FYX EPWS XLI PIET MRXS IPIGXVSRMG XCTIWIXXMRK, VIQEMRMRK IWWIRXMEPPC YRGLERKIH. MX AEW TSTYPEVMWIH MR XLI 1960W AMXL XLI VIPIEWI SJ PIXVEWIX WLIIXW GSRXEMRMRK PSVIQ MTWYQ TEWWEKIW, ERH QSVI VIGIRXPC AMXL HIWOXST TYFPMWLMRK WSJXAEVI PMOI EPHYW TEKIQEOIV MRGPYHMRK ZIVWMSRW SJ PSVIQ MTWYQ", 10, self.alphabet_eng, 4), "LOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUMLOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUM LOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUMLOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUM")

    def test_decrypt_by_frequency_analysis(self):
        original_text = "LOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUMLOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUM LOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUMLOREM IPSUM IS SIMPLY DUMMY TEXT OF THE PRINTING AND TYPESETTING INDUSTRY. LOREM IPSUM HAS BEEN THE INDUSTRY'S STANDARD DUMMY TEXT EVER SINCE THE 1500S, WHEN AN UNKNOWN PRINTER TOOK A GALLEY OF TYPE AND SCRAMBLED IT TO MAKE A TYPE SPECIMEN BOOK. IT HAS SURVIVED NOT ONLY FIVE CENTURIES, BUT ALSO THE LEAP INTO ELECTRONIC TYPESETTING, REMAINING ESSENTIALLY UNCHANGED. IT WAS POPULARISED IN THE 1960S WITH THE RELEASE OF LETRASET SHEETS CONTAINING LOREM IPSUM PASSAGES, AND MORE RECENTLY WITH DESKTOP PUBLISHING SOFTWARE LIKE ALDUS PAGEMAKER INCLUDING VERSIONS OF LOREM IPSUM"        
        original_key = 4

        encrypted_text = caesars_cipher_encrypt(original_text, self.alphabet_eng, original_key)

        self.assertNotEqual(encrypted_text, original_text)

        detected_key = frequency_analysis(encrypted_text, self.alphabet_eng, "text_frequency_analysis.txt")
        decrypted_text = caesars_cipher_decrypt_by_frequency_analysis(encrypted_text, self.alphabet_eng, "test_freq_analysis.txt")

        self.assertEqual(detected_key, original_key)
        self.assertEqual(decrypted_text, original_text)
if __name__ == "__main__":
    unittest.main(exit=False)